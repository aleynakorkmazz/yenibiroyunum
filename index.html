<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aleyna Korkmaz | Kişisel Web Sitesi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #e74c3c;
            --accent: #3498db;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --pacman-yellow: #f1c40f;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        /* Navigasyon */
        nav {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-links { display: flex; gap: 20px; }
        .nav-item { position: relative; cursor: pointer; padding: 5px 10px; }
        .nav-item:hover { color: var(--accent); }
        .dropdown {
            display: none;
            position: absolute;
            background-color: white;
            color: black;
            top: 100%; left: 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 4px;
            min-width: 180px;
            z-index: 1001;
        }
        .nav-item:hover .dropdown { display: block; }
        .dropdown div { padding: 10px; border-bottom: 1px solid #eee; transition: 0.3s; }
        .dropdown div:hover { background-color: var(--light); color: var(--secondary); }

        .top-right-info { display: flex; align-items: center; gap: 15px; font-size: 0.9rem; }
        .version { background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 4px; font-weight: bold; }
        .log-btn {
            background-color: var(--secondary); border: none; color: white;
            padding: 5px 15px; border-radius: 20px; cursor: pointer; transition: 0.3s;
        }
        .log-btn:hover { background-color: #c0392b; }

        /* Hero Header */
        header.hero {
            text-align: center; padding: 50px 20px;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
        }
        .hero h1 { margin: 0; font-size: 2.5rem; }
        .hero p { font-size: 1.2rem; margin-top: 10px; opacity: 0.9; }

        .container {
            max-width: 1000px; margin: 20px auto; padding: 20px;
            background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            min-height: 400px;
        }

        /* Modal Yapısı */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 2000;
        }
        .modal-content {
            background: white; padding: 20px; border-radius: 8px;
            max-width: 700px; width: 95%; position: relative; max-height: 90vh; overflow-y: auto;
        }
        .close-btn {
            position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #aaa;
        }
        .close-btn:hover { color: black; }

        /* Tablolar */
        table.log-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .log-table th, .log-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .log-table th { background-color: var(--primary); color: white; }

        /* --- OYUN ALANI TASARIMI --- */
        #game-modal-content {
            background: #111; color: white; text-align: center; 
            display: flex; flex-direction: column; align-items: center;
            border: 1px solid #333;
        }

        .game-wrapper {
            display: flex;
            gap: 20px;
            align-items: flex-start;
            justify-content: center;
            margin-top: 10px;
        }

        canvas {
            background-color: #000; display: block;
            border: 2px solid #555; box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .game-info-panel {
            background: #222;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            min-width: 120px;
            border: 1px solid #444;
        }

        .game-stat { margin-bottom: 10px; font-family: monospace; font-size: 1.1rem; }
        .game-stat label { color: #888; display: block; font-size: 0.8rem; }
        .game-stat span { color: #f1c40f; font-weight: bold; }

        .lives i { color: #e74c3c; margin-right: 3px; }
        
        #nextPieceCanvas {
            background: #000;
            border: 1px solid #333;
            margin-top: 5px;
        }

        footer {
            text-align: center; padding: 20px; background-color: var(--primary);
            color: white; margin-top: 40px;
        }

        /* Mobil Kontroller */
        .mobile-controls {
            display: none; /* Mobilde açılabilir */
            gap: 10px; margin-top: 10px;
        }
        .m-btn {
            padding: 15px; background: rgba(255,255,255,0.1); border: 1px solid #555; color: white; border-radius: 5px;
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo"><i class="fa-solid fa-code"></i> Aleyna Korkmaz</div>
        <div class="nav-links">
            <div class="nav-item">
                <i class="fa-solid fa-gamepad"></i> Oyunlar
                <div class="dropdown">
                    <div onclick="initGame('tetris')"><i class="fa-solid fa-shapes"></i> Tetris (Geleceği Gör)</div>
                    <div onclick="initGame('pacman')"><i class="fa-solid fa-ghost"></i> Pacman: Avcı Modu</div>
                    <div onclick="initGame('snake')"><i class="fa-solid fa-staff-snake"></i> Gerçekçi Yılan</div>
                </div>
            </div>
            <div class="nav-item" onclick="showSection('notes')"><i class="fa-solid fa-book"></i> Ders Notları</div>
            <div class="nav-item" onclick="showSection('movies')"><i class="fa-solid fa-film"></i> Filmler</div>
        </div>
        <div class="top-right-info">
            <span class="version">v1.2.0</span>
            <button class="log-btn" onclick="toggleLog()"><i class="fa-solid fa-clipboard-list"></i> Günlük</button>
        </div>
    </nav>

    <header class="hero">
        <h1>Hoş Geldiniz</h1>
        <p>Ben Aleyna Korkmaz. Matematik Öğrencisi & Veri Analisti Adayı.</p>
        <p style="font-size: 0.9rem; margin-top:5px;">Python | SQL | Veri Analizi | Oyun Geliştirme</p>
    </header>

    <div class="container" id="main-content">
        <h2>Hakkımda</h2>
        <p>Merhaba! İstanbul Üniversitesi Matematik bölümü öğrencisiyim. Veri analitiği ve yazılım geliştirme üzerine çalışıyorum. Bu site, projelerimi sergilediğim kişisel alanımdır.</p>
        <p>Oyunlar menüsünden JavaScript ile geliştirdiğim oyunları deneyebilirsiniz. Özellikle Pacman'de hayaletleri avlamayı unutmayın!</p>
        <div id="dynamic-content"></div>
    </div>

    <div id="logModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="toggleLog()">&times;</span>
            <h3><i class="fa-solid fa-history"></i> Geliştirme Günlüğü</h3>
            <table class="log-table">
                <thead><tr><th>Tarih</th><th>Sürüm</th><th>Geliştirmeler</th></tr></thead>
                <tbody id="logTableBody"></tbody>
            </table>
        </div>
    </div>

    <div id="gameModal" class="modal">
        <div class="modal-content" id="game-modal-content">
            <span class="close-btn" onclick="stopGame()" style="color: white; right: 20px; z-index:100;">&times;</span>
            <h3 id="gameTitle" style="margin: 10px 0; color: #f1c40f;">Oyun</h3>
            
            <div class="game-wrapper">
                <canvas id="gameCanvas"></canvas>

                <div class="game-info-panel">
                    <div class="game-stat">
                        <label>SKOR</label>
                        <span id="scoreVal">0</span>
                    </div>
                    <div class="game-stat" id="levelContainer">
                        <label>SEVİYE</label>
                        <span id="levelVal">1</span>
                    </div>
                    <div class="game-stat" id="livesContainer" style="display:none;">
                        <label>CAN</label>
                        <span id="livesVal" class="lives"></span>
                    </div>
                    <div class="game-stat" id="timeContainer" style="display:none;">
                        <label>SÜRE</label>
                        <span id="timeVal">60</span> sn
                    </div>
                    <div id="nextPieceContainer" style="display:none; margin-top:10px;">
                        <label>SIRADAKİ</label>
                        <canvas id="nextPieceCanvas" width="80" height="80"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="mobile-controls">
                <button class="m-btn" onmousedown="handleInput('ArrowUp')">▲</button>
                <br>
                <button class="m-btn" onmousedown="handleInput('ArrowLeft')">◄</button>
                <button class="m-btn" onmousedown="handleInput('ArrowDown')">▼</button>
                <button class="m-btn" onmousedown="handleInput('ArrowRight')">►</button>
            </div>
            
            <p style="color: #666; font-size: 0.8rem; margin-top: 10px;">PC: Yön Tuşları ile oynayın.</p>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 Aleyna Korkmaz. Tüm hakları saklıdır.</p>
    </footer>

    <script>
        /* --- VERİLER --- */
        const logs = [
            { date: "07.02.2026", version: "1.2.0", text: "Pacman Avcı Modu (Hayalet Yeme), Tetris Sonraki Blok, Gelişmiş Yılan Görseli eklendi." },
            { date: "07.02.2026", version: "1.1.0", text: "Oyun motorları güncellendi." },
            { date: "07.02.2026", version: "1.0.0", text: "İlk yayın." }
        ];

        /* --- SİTE FONKSİYONLARI --- */
        function toggleLog() {
            const modal = document.getElementById('logModal');
            const tbody = document.getElementById('logTableBody');
            if (modal.style.display === 'flex') {
                modal.style.display = 'none';
            } else {
                tbody.innerHTML = logs.map(log => `<tr><td>${log.date}</td><td>${log.version}</td><td>${log.text}</td></tr>`).join('');
                modal.style.display = 'flex';
            }
        }

        function showSection(section) {
            const content = document.getElementById('dynamic-content');
            if (section === 'notes') content.innerHTML = `<h3><i class="fa-solid fa-book"></i> Ders Notları</h3><p>Veri Analizi ve Matematik notları hazırlanıyor...</p>`;
            if (section === 'movies') content.innerHTML = `<h3><i class="fa-solid fa-film"></i> Filmler</h3><p>Yakında favori filmler listesi eklenecek.</p>`;
        }

        /* --- OYUN MOTORU GÖVDE --- */
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const nextCanvas = document.getElementById('nextPieceCanvas');
        const nextCtx = nextCanvas.getContext('2d');
        
        let gameInterval, timerInterval;
        let activeGame = null;
        let score = 0, level = 1, lives = 3, timeLeft = 60;

        // UI Elementleri
        const uiScore = document.getElementById('scoreVal');
        const uiLevel = document.getElementById('levelVal');
        const uiLives = document.getElementById('livesVal');
        const uiTime = document.getElementById('timeVal');
        const contLives = document.getElementById('livesContainer');
        const contTime = document.getElementById('timeContainer');
        const contNext = document.getElementById('nextPieceContainer');

        function initGame(gameName) {
            document.getElementById('gameModal').style.display = 'flex';
            activeGame = gameName;
            score = 0; level = 1; lives = 3; timeLeft = 60;
            updateUI();
            
            // UI Temizle
            contLives.style.display = 'none';
            contTime.style.display = 'none';
            contNext.style.display = 'none';

            if (gameInterval) clearInterval(gameInterval);
            if (timerInterval) clearInterval(timerInterval);

            if(gameName === 'tetris') {
                canvas.width = 240; canvas.height = 400;
                contNext.style.display = 'block';
                startTetris();
            } else if(gameName === 'snake') {
                canvas.width = 400; canvas.height = 400;
                startSnake();
            } else if(gameName === 'pacman') {
                canvas.width = 380; canvas.height = 380;
                contLives.style.display = 'block';
                contTime.style.display = 'block';
                startPacman();
            }
        }

        function stopGame() {
            clearInterval(gameInterval);
            clearInterval(timerInterval);
            document.getElementById('gameModal').style.display = 'none';
            activeGame = null;
        }

        function updateUI() {
            uiScore.innerText = score;
            uiLevel.innerText = level;
            uiLives.innerHTML = '<i class="fa-solid fa-heart"></i>'.repeat(lives);
            uiTime.innerText = timeLeft;
        }

        // Sanal Tuş (Mobil)
        function handleInput(key) {
            const event = new KeyboardEvent('keydown', {'key': key});
            document.dispatchEvent(event);
        }

        /* ==================== 1. YILAN OYUNU (Görsel İyileştirilmiş) ==================== */
        function startSnake() {
            document.getElementById('gameTitle').innerText = "Yılan";
            const box = 20;
            let snake = [{x: 9 * box, y: 10 * box}];
            let food = {x: Math.floor(Math.random()*19+1) * box, y: Math.floor(Math.random()*19+1) * box};
            let d = "RIGHT"; // Varsayılan yön
            
            function draw() {
                // Arkaplan
                ctx.fillStyle = "#222";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Izgara (Opsiyonel estetik)
                ctx.strokeStyle = "#333";
                ctx.lineWidth = 0.5;
                for(let i=0; i<canvas.width; i+=box) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke(); }
                for(let i=0; i<canvas.height; i+=box) { ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width,i); ctx.stroke(); }

                // Yılanı Çiz
                for(let i = 0; i < snake.length; i++) {
                    // Renk: Baş koyu yeşil, vücut açık yeşil gradient
                    ctx.fillStyle = (i == 0) ? "#27ae60" : "#2ecc71";
                    
                    // Yuvarlak hatlar
                    ctx.beginPath();
                    ctx.roundRect(snake[i].x, snake[i].y, box, box, [5]);
                    ctx.fill();

                    // Gözler (Sadece Baş İçin)
                    if(i === 0) {
                        ctx.fillStyle = "white";
                        // Yöne göre göz pozisyonu
                        let eyeOffsetX = 5, eyeOffsetY = 5;
                        if(d === "RIGHT") { eyeOffsetX = 12; }
                        if(d === "LEFT") { eyeOffsetX = 2; }
                        if(d === "UP") { eyeOffsetY = 2; eyeOffsetX = 5; }
                        if(d === "DOWN") { eyeOffsetY = 12; eyeOffsetX = 5; }

                        ctx.beginPath(); ctx.arc(snake[i].x + eyeOffsetX, snake[i].y + 5, 2, 0, Math.PI*2); ctx.fill();
                        ctx.beginPath(); ctx.arc(snake[i].x + eyeOffsetX, snake[i].y + 15, 2, 0, Math.PI*2); ctx.fill();
                    }
                }

                // Yemek
                ctx.fillStyle = "#e74c3c"; // Kırmızı Elma
                ctx.beginPath();
                ctx.arc(food.x + box/2, food.y + box/2, box/2 - 2, 0, Math.PI*2);
                ctx.fill();

                // Hareket Mantığı
                let snakeX = snake[0].x;
                let snakeY = snake[0].y;

                if(d == "LEFT") snakeX -= box;
                if(d == "UP") snakeY -= box;
                if(d == "RIGHT") snakeX += box;
                if(d == "DOWN") snakeY += box;

                // Yeme Durumu
                if(snakeX == food.x && snakeY == food.y) {
                    score += 10;
                    updateUI();
                    food = {
                        x: Math.floor(Math.random()*19) * box,
                        y: Math.floor(Math.random()*19) * box
                    };
                } else {
                    snake.pop();
                }

                // Çarpışma
                let newHead = {x: snakeX, y: snakeY};
                if(snakeX < 0 || snakeX >= canvas.width || snakeY < 0 || snakeY >= canvas.height || collision(newHead, snake)) {
                    clearInterval(gameInterval);
                    alert("Yılan Çarptı! Skor: " + score);
                }
                snake.unshift(newHead);
            }

            function collision(head, array) {
                for(let i = 0; i < array.length; i++) {
                    if(head.x == array[i].x && head.y == array[i].y) return true;
                }
                return false;
            }

            document.onkeydown = function(event){
                if(activeGame !== 'snake') return;
                let key = event.key;
                if(key == "ArrowLeft" && d != "RIGHT") d = "LEFT";
                else if(key == "ArrowUp" && d != "DOWN") d = "UP";
                else if(key == "ArrowRight" && d != "LEFT") d = "RIGHT";
                else if(key == "ArrowDown" && d != "UP") d = "DOWN";
            };

            gameInterval = setInterval(draw, 100);
        }


        /* ==================== 2. TETRIS (Next Block Özellikli) ==================== */
        function startTetris() {
            document.getElementById('gameTitle').innerText = "Tetris";
            const ROW = 20, COL = 12, SQ = 20;
            const VACANT = "BLACK";
            let board = [];
            for(let r=0; r<ROW; r++){
                board[r] = [];
                for(let c=0; c<COL; c++){ board[r][c] = VACANT; }
            }

            // Tetrominolar ve Renkler
            const PIECES = [
                [Z,"#e74c3c"], [S,"#2ecc71"], [T,"#9b59b6"], [O,"#f1c40f"], 
                [L,"#e67e22"], [I,"#3498db"], [J,"#34495e"]
            ];

            let p, nextP;

            function drawSquare(x,y,color, context = ctx){
                context.fillStyle = color;
                context.fillRect(x*SQ, y*SQ, SQ, SQ);
                context.strokeStyle = "#222";
                context.strokeRect(x*SQ, y*SQ, SQ, SQ);
            }

            function drawBoard(){
                for(let r=0; r<ROW; r++){
                    for(let c=0; c<COL; c++){ drawSquare(c, r, board[r][c]); }
                }
            }

            function drawNextPiece() {
                nextCtx.fillStyle = "#000";
                nextCtx.fillRect(0, 0, nextCanvas.width, nextCanvas.height);
                // Next Piece'i ortala ve çiz
                let offsetX = (4 - nextP.activeTetromino.length)/2;
                for(let r=0; r<nextP.activeTetromino.length; r++){
                    for(let c=0; c<nextP.activeTetromino.length; c++){
                        if(nextP.activeTetromino[r][c]){
                            drawSquare(c + 0.5, r + 0.5, nextP.color, nextCtx);
                        }
                    }
                }
            }

            function Piece(tetromino, color){
                this.tetromino = tetromino;
                this.color = color;
                this.tetrominoN = 0;
                this.activeTetromino = this.tetromino[this.tetrominoN];
                this.x = 4;
                this.y = 0;
            }
            
            // ... (Piece methods: fill, draw, unDraw, moveDown vs. same as before)
            Piece.prototype.fill = function(color){
                for(let r=0; r<this.activeTetromino.length; r++){
                    for(let c=0; c<this.activeTetromino.length; c++){
                        if(this.activeTetromino[r][c]){
                            drawSquare(this.x + c, this.y + r, color);
                        }
                    }
                }
            }
            Piece.prototype.draw = function(){ this.fill(this.color); }
            Piece.prototype.unDraw = function(){ this.fill(VACANT); }
            Piece.prototype.moveDown = function(){
                if(!this.collision(0,1,this.activeTetromino)){
                    this.unDraw(); this.y++; this.draw();
                }else{
                    this.lock();
                    p = nextP; // Sıradaki parça artık şimdiki parça
                    let r = Math.floor(Math.random() * PIECES.length);
                    nextP = new Piece(PIECES[r][0], PIECES[r][1]); // Yeni sıradaki parça
                    drawNextPiece();
                }
            }
            Piece.prototype.moveRight = function(){ if(!this.collision(1,0,this.activeTetromino)){ this.unDraw(); this.x++; this.draw(); } }
            Piece.prototype.moveLeft = function(){ if(!this.collision(-1,0,this.activeTetromino)){ this.unDraw(); this.x--; this.draw(); } }
            Piece.prototype.rotate = function(){
                let nextPattern = this.tetromino[(this.tetrominoN + 1)%this.tetromino.length];
                let kick = 0;
                if(this.collision(0,0,nextPattern)){ if(this.x > COL/2) kick = -1; else kick = 1; }
                if(!this.collision(kick,0,nextPattern)){
                    this.unDraw(); this.x += kick;
                    this.tetrominoN = (this.tetrominoN + 1)%this.tetromino.length;
                    this.activeTetromino = this.tetromino[this.tetrominoN];
                    this.draw();
                }
            }
            Piece.prototype.collision = function(x,y,piece){
                for(let r=0; r<piece.length; r++){
                    for(let c=0; c<piece.length; c++){
                        if(!piece[r][c]) continue;
                        let newX = this.x + c + x;
                        let newY = this.y + r + y;
                        if(newX < 0 || newX >= COL || newY >= ROW) return true;
                        if(newY < 0) continue;
                        if(board[newY][newX] != VACANT) return true;
                    }
                }
                return false;
            }
            Piece.prototype.lock = function(){
                for(let r=0; r<this.activeTetromino.length; r++){
                    for(let c=0; c<this.activeTetromino.length; c++){
                        if(!this.activeTetromino[r][c]) continue;
                        if(this.y + r < 0){ alert("Oyun Bitti!"); stopGame(); return; }
                        board[this.y+r][this.x+c] = this.color;
                    }
                }
                // Satır Silme
                for(let r=0; r<ROW; r++){
                    let isRowFull = true;
                    for(let c=0; c<COL; c++){ isRowFull = isRowFull && (board[r][c] != VACANT); }
                    if(isRowFull){
                        for(let y=r; y>1; y--){ for(let c=0; c<COL; c++){ board[y][c] = board[y-1][c]; } }
                        for(let c=0; c<COL; c++) board[0][c] = VACANT;
                        score += 100; updateUI();
                    }
                }
                drawBoard();
            }

            // İlk Başlatma
            let r = Math.floor(Math.random() * PIECES.length);
            p = new Piece(PIECES[r][0], PIECES[r][1]);
            
            r = Math.floor(Math.random() * PIECES.length);
            nextP = new Piece(PIECES[r][0], PIECES[r][1]);
            
            drawBoard();
            drawNextPiece();

            document.onkeydown = function(e){
                if(activeGame !== 'tetris') return;
                if(e.key == "ArrowLeft") p.moveLeft();
                else if(e.key == "ArrowUp") p.rotate();
                else if(e.key == "ArrowRight") p.moveRight();
                else if(e.key == "ArrowDown") p.moveDown();
            }
            gameInterval = setInterval(() => { p.moveDown(); }, 500);
        }

        /* ==================== 3. PACMAN (Avcı Modu & Süreli & Canlı) ==================== */
        function startPacman() {
            document.getElementById('gameTitle').innerText = "Pacman (Avcı Modu)";
            const TILE = 20;
            // 0:Yem, 1:Duvar, 2:Boş, 3:GÜÇ YEMİ (Büyük), 9:Pacman
            const mapLayout = [
                [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                [1,3,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,3,1], // Köşelerde Güç Yemi
                [1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1],
                [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                [1,0,1,1,0,1,0,1,1,2,1,1,0,1,0,1,1,0,1],
                [1,0,0,0,0,1,0,2,2,2,2,2,0,1,0,0,0,0,1],
                [1,1,1,1,0,1,1,1,2,2,2,1,1,1,0,1,1,1,1], // Ortada Hayalet Evi (2)
                [1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1],
                [1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1],
                [1,3,0,1,0,0,0,0,0,9,0,0,0,0,0,1,0,3,1], // Pacman (9)
                [1,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,0,1,1],
                [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1],
                [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
            ];
            
            // Harita kopyası (Resetlenebilir olması için)
            let map = JSON.parse(JSON.stringify(mapLayout));

            let pacman = {x: 9, y: 9, dirX:0, dirY:0, nextX:0, nextY:0};
            let ghosts = [
                {x:9, y:6, color:'red', state:'normal'},
                {x:8, y:6, color:'pink', state:'normal'},
                {x:10, y:6, color:'cyan', state:'normal'},
                {x:9, y:5, color:'orange', state:'normal'}
            ];
            
            let powerModeTime = 0;

            // Zamanlayıcı
            timerInterval = setInterval(() => {
                if(activeGame !== 'pacman') return;
                timeLeft--;
                updateUI();
                if(timeLeft <= 0) {
                    lives--;
                    updateUI();
                    if(lives > 0) {
                        alert("Süre bitti! Canınız azaldı.");
                        timeLeft = 60;
                        resetPositions();
                    } else {
                        alert("OYUN BİTTİ! Tüm canlarınızı kaybettiniz.");
                        stopGame();
                    }
                }
                
                // Güç Modu Geri Sayım
                if(powerModeTime > 0) {
                    powerModeTime--;
                    if(powerModeTime <= 0) ghosts.forEach(g => g.state = 'normal');
                }
            }, 1000);

            function resetPositions() {
                pacman = {x: 9, y: 9, dirX:0, dirY:0, nextX:0, nextY:0};
                ghosts = [
                    {x:9, y:6, color:'red', state:'normal'},
                    {x:8, y:6, color:'pink', state:'normal'},
                    {x:10, y:6, color:'cyan', state:'normal'},
                    {x:9, y:5, color:'orange', state:'normal'}
                ];
            }

            function update() {
                // Yön Güncelleme
                if(map[pacman.y + pacman.nextY][pacman.x + pacman.nextX] !== 1) {
                    pacman.dirX = pacman.nextX; pacman.dirY = pacman.nextY;
                }
                
                // Pacman Hareket
                if(map[pacman.y + pacman.dirY][pacman.x + pacman.dirX] !== 1) {
                    pacman.x += pacman.dirX; pacman.y += pacman.dirY;
                }

                let tile = map[pacman.y][pacman.x];
                // Yem Yeme
                if(tile === 0) { map[pacman.y][pacman.x] = 2; score += 10; updateUI(); }
                // GÜÇ YEMİ Yeme
                if(tile === 3) {
                    map[pacman.y][pacman.x] = 2;
                    score += 50;
                    powerModeTime = 10; // 10 saniye boyunca ye
                    ghosts.forEach(g => g.state = 'scared');
                    updateUI();
                }

                // Hayalet Mantığı
                ghosts.forEach((g, index) => {
                    // Basit Rastgele Hareket + Duvar Kontrolü
                    let dirs = [{x:0, y:-1}, {x:0, y:1}, {x:-1, y:0}, {x:1, y:0}];
                    let validDirs = dirs.filter(d => map[g.y+d.y][g.x+d.x] !== 1);
                    
                    if(validDirs.length > 0) {
                        // Eğer korkmuşsa Pacman'den uzağa gitmeye çalışır (basit mantık)
                        let move = validDirs[Math.floor(Math.random()*validDirs.length)];
                        g.x += move.x; g.y += move.y;
                    }

                    // Çarpışma
                    if(g.x === pacman.x && g.y === pacman.y) {
                        if(g.state === 'scared') {
                            // Hayaleti Ye!
                            score += 200;
                            ghosts.splice(index, 1); // Hayaleti sil
                            updateUI();
                            
                            // SEVİYE ATLAMA KONTROLÜ (Tüm hayaletler yendi mi?)
                            if(ghosts.length === 0) {
                                alert("TEBRİKLER! Tüm hayaletleri temizlediniz! Seviye Atlandı!");
                                level++;
                                timeLeft = 60; // Süreyi resetle
                                map = JSON.parse(JSON.stringify(mapLayout)); // Haritayı resetle
                                resetPositions();
                                updateUI();
                            }
                        } else {
                            // Pacman Yendi :(
                            lives--;
                            updateUI();
                            if(lives <= 0) {
                                alert("Oyun Bitti! Hayaletler sizi yedi.");
                                stopGame();
                            } else {
                                resetPositions();
                            }
                        }
                    }
                });

                draw();
            }

            function draw() {
                ctx.fillStyle = "black"; ctx.fillRect(0,0,canvas.width, canvas.height);
                
                // Harita
                for(let r=0; r<map.length; r++){
                    for(let c=0; c<map[0].length; c++){
                        if(map[r][c] === 1) { ctx.fillStyle = "blue"; ctx.fillRect(c*TILE, r*TILE, TILE, TILE); }
                        else if(map[r][c] === 0) { ctx.fillStyle = "#ffb897"; ctx.beginPath(); ctx.arc(c*TILE+TILE/2, r*TILE+TILE/2, 3, 0, Math.PI*2); ctx.fill(); }
                        else if(map[r][c] === 3) { ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.arc(c*TILE+TILE/2, r*TILE+TILE/2, 7, 0, Math.PI*2); ctx.fill(); } // Güç Yemi
                    }
                }

                // Pacman
                ctx.fillStyle = "yellow";
                ctx.beginPath();
                // Basit ağız animasyonu yönü
                ctx.arc(pacman.x*TILE + TILE/2, pacman.y*TILE + TILE/2, TILE/2-2, 0.2*Math.PI, 1.8*Math.PI);
                ctx.lineTo(pacman.x*TILE + TILE/2, pacman.y*TILE + TILE/2);
                ctx.fill();

                // Hayaletler
                ghosts.forEach(g => {
                    ctx.fillStyle = (g.state === 'scared') ? 'blue' : g.color; // Korkunca mavi ol
                    ctx.beginPath();
                    ctx.arc(g.x*TILE + TILE/2, g.y*TILE + TILE/2, TILE/2-2, 0, Math.PI*2);
                    ctx.fill();
                });
            }

            document.onkeydown = function(e){
                if(activeGame !== 'pacman') return;
                if(e.key === "ArrowUp") { pacman.nextX=0; pacman.nextY=-1; }
                if(e.key === "ArrowDown") { pacman.nextX=0; pacman.nextY=1; }
                if(e.key === "ArrowLeft") { pacman.nextX=-1; pacman.nextY=0; }
                if(e.key === "ArrowRight") { pacman.nextX=1; pacman.nextY=0; }
            };

            gameInterval = setInterval(update, 200);
        }

        // Global Tetromino Shapes
        const I = [[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]], [[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]]];
        const J = [[[1,0,0],[1,1,1],[0,0,0]], [[0,1,1],[0,1,0],[0,1,0]], [[0,0,0],[1,1,1],[0,0,1]], [[0,1,0],[0,1,0],[1,1,0]]];
        const L = [[[0,0,1],[1,1,1],[0,0,0]], [[0,1,0],[0,1,0],[0,1,1]], [[0,0,0],[1,1,1],[1,0,0]], [[1,1,0],[0,1,0],[0,1,0]]];
        const O = [[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]];
        const S = [[[0,1,1],[1,1,0],[0,0,0]], [[0,1,0],[0,1,1],[0,0,1]]];
        const T = [[[0,1,0],[1,1,1],[0,0,0]], [[0,1,0],[0,1,1],[0,1,0]], [[0,0,0],[1,1,1],[0,1,0]], [[0,1,0],[1,1,0],[0,1,0]]];
        const Z = [[[1,1,0],[0,1,1],[0,0,0]], [[0,0,1],[0,1,1],[0,1,0]]];

    </script>
</body>
</html>
