<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aleyna Korkmaz | YKS & Oyunlar</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #00cec9;
            --accent: #fd79a8;
            --dark: #2d3436;
            --light: #dfe6e9;
            --bg-grad: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0; background: var(--bg-grad); color: var(--dark); min-height: 100vh; }

        /* NAVİGASYON */
        nav { background: rgba(255, 255, 255, 0.95); padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        .logo { font-size: 1.5rem; font-weight: 800; color: var(--primary); cursor: pointer; text-decoration: none; }
        .nav-links { display: flex; gap: 30px; }
        .nav-item { cursor: pointer; font-weight: 600; transition: 0.3s; color: var(--dark); }
        .nav-item:hover { color: var(--primary); }

        /* HERO */
        header.hero { text-align: center; padding: 60px 20px 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 0 0 40px 40px; box-shadow: 0 10px 30px rgba(118, 75, 162, 0.3); margin-bottom: 40px; }
        .hero h1 { font-size: 3rem; margin: 0; font-weight: 800; }
        .tagline { background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-size: 0.9rem; margin-top: 10px; display: inline-block; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px 40px; }

        /* KARTLAR */
        .home-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .feature-card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.05); transition: 0.3s; cursor: pointer; border: 1px solid rgba(0,0,0,0.05); }
        .feature-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .card-icon { height: 120px; display: flex; align-items: center; justify-content: center; font-size: 4rem; color: white; }
        .icon-notes { background: linear-gradient(45deg, #ff9a9e, #fad0c4); }
        .icon-games { background: linear-gradient(45deg, #a18cd1, #fbc2eb); }
        .icon-movies { background: linear-gradient(45deg, #84fab0, #8fd3f4); }
        .card-body { padding: 25px; text-align: center; }
        .card-body h3 { margin: 0 0 10px; color: var(--dark); font-size: 1.5rem; }
        .card-body p { color: #777; font-size: 0.9rem; margin: 0; }

        /* MODAL GENEL */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center;
            opacity: 0; visibility: hidden; transition: 0.3s; z-index: 2000;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal-content {
            background: white; width: 95%; max-width: 900px; height: 90vh;
            border-radius: 20px; display: flex; flex-direction: column; overflow: hidden;
            position: relative;
        }
        .modal-header {
            padding: 15px 25px; background: #f1f2f6; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd;
        }
        .modal-title { font-weight: bold; font-size: 1.2rem; color: var(--primary); }
        .close-btn { 
            background: #ff7675; color: white; border: none; width: 30px; height: 30px; 
            border-radius: 50%; cursor: pointer; font-size: 1rem; 
        }
        .modal-body { flex: 1; overflow-y: auto; padding: 20px; background: #fafafa; }

        /* OYUN MENÜSÜ & ALANI */
        .game-selection { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; text-align: center; }
        .game-thumb {
            background: white; border: 2px solid #eee; border-radius: 15px; padding: 20px;
            cursor: pointer; transition: 0.3s;
        }
        .game-thumb:hover { border-color: var(--primary); transform: scale(1.05); }
        .game-thumb i { font-size: 3rem; margin-bottom: 10px; color: var(--accent); }
        
        .game-stage { display: none; flex-direction: column; align-items: center; height: 100%; justify-content: center; }
        .game-stage.active { display: flex; }
        
        canvas { background: #2d3436; border-radius: 10px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); max-width: 100%; }
        
        .game-controls { margin-top: 15px; display: flex; gap: 10px; }
        .ctrl-btn { padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .ctrl-btn.stop { background: #ff7675; }
        
        .score-display { font-size: 1.5rem; font-weight: bold; margin-bottom: 10px; color: var(--dark); }

        /* DERS NOTLARI STİLİ */
        .subject-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 15px; }
        .subject-item { background: white; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #eee; font-weight: 600; color: #555; }
        .subject-item.mat { border-bottom: 4px solid #e17055; }
        .subject-item.fiz { border-bottom: 4px solid #0984e3; }
        .subject-item.bio { border-bottom: 4px solid #00b894; }

        /* FİLMLER STİLİ */
        .movie-list { list-style: none; padding: 0; }
        .movie-list li { background: white; padding: 15px; margin-bottom: 10px; border-radius: 10px; display: flex; align-items: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .movie-list li i { color: var(--accent); }

    </style>
</head>
<body>

    <nav>
        <a href="#" class="logo">ALEY</a>
        <div class="nav-links">
            <div class="nav-item" onclick="openModal('notes')">Notlar</div>
            <div class="nav-item" onclick="openModal('games')">Oyunlar</div>
            <div class="nav-item" onclick="openModal('movies')">Filmler</div>
        </div>
    </nav>

    <header class="hero">
        <h1>Hoş Geldin Aleyna!</h1>
        <div class="tagline">YKS Maratonu & Oyun Molası</div>
    </header>

    <div class="container">
        <div class="home-grid">
            <div class="feature-card" onclick="openModal('notes')">
                <div class="card-icon icon-notes"><i class="fas fa-book-open"></i></div>
                <div class="card-body">
                    <h3>Ders Notları</h3>
                    <p>Matematik, Fizik, Biyoloji özetleri.</p>
                </div>
            </div>

            <div class="feature-card" onclick="openModal('games')">
                <div class="card-icon icon-games"><i class="fas fa-gamepad"></i></div>
                <div class="card-body">
                    <h3>Oyun Odası</h3>
                    <p>Tetris, Yılan ve Pac-Man ile stres at.</p>
                </div>
            </div>

            <div class="feature-card" onclick="openModal('movies')">
                <div class="card-icon icon-movies"><i class="fas fa-film"></i></div>
                <div class="card-body">
                    <h3>İzlenecekler</h3>
                    <p>Sınav sonrası film listesi.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-notes" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Ders Notları</span>
                <button class="close-btn" onclick="closeModal('notes')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <h3>Konu Özetleri</h3>
                <div class="subject-list">
                    <div class="subject-item mat">Türev</div>
                    <div class="subject-item mat">İntegral</div>
                    <div class="subject-item mat">Limit</div>
                    <div class="subject-item fiz">Atışlar</div>
                    <div class="subject-item fiz">Optik</div>
                    <div class="subject-item bio">Sistemler</div>
                    <div class="subject-item bio">Bitki Bio</div>
                </div>
                <p style="margin-top:20px; color:#777;">* Detaylı notlar PDF olarak yüklenecek.</p>
            </div>
        </div>
    </div>

    <div id="modal-movies" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">İzlenecekler Listesi</span>
                <button class="close-btn" onclick="closeModal('movies')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <ul class="movie-list">
                    <li><i class="fas fa-play-circle"></i> Interstellar</li>
                    <li><i class="fas fa-play-circle"></i> 3 Idiots</li>
                    <li><i class="fas fa-play-circle"></i> The Pursuit of Happyness</li>
                    <li><i class="fas fa-play-circle"></i> Everything Everywhere All At Once</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="modal-games" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">Oyun Merkezi</span>
                <button class="close-btn" onclick="closeAllGames(); closeModal('games')"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                
                <div id="game-menu" class="game-selection">
                    <div class="game-thumb" onclick="startTetris()">
                        <i class="fas fa-shapes"></i>
                        <h3>Tetris</h3>
                    </div>
                    <div class="game-thumb" onclick="startSnake()">
                        <i class="fas fa-dragon"></i>
                        <h3>Yılan</h3>
                    </div>
                    <div class="game-thumb" onclick="startPacman()">
                        <i class="fas fa-ghost"></i>
                        <h3>Pac-Man</h3>
                    </div>
                </div>

                <div id="stage-tetris" class="game-stage">
                    <div class="score-display">Skor: <span id="tetris-score">0</span></div>
                    <canvas id="tetris-canvas" width="240" height="400"></canvas>
                    <div class="game-controls">
                        <button class="ctrl-btn stop" onclick="showGameMenu()">Çıkış</button>
                        <small style="margin-left:10px; align-self:center;">Yön Tuşlarını Kullan</small>
                    </div>
                </div>

                <div id="stage-snake" class="game-stage">
                    <div class="score-display">Skor: <span id="snake-score">0</span></div>
                    <canvas id="snake-canvas" width="400" height="400"></canvas>
                    <div class="game-controls">
                        <button class="ctrl-btn stop" onclick="showGameMenu()">Çıkış</button>
                        <small style="margin-left:10px; align-self:center;">Yön Tuşlarını Kullan</small>
                    </div>
                </div>

                <div id="stage-pacman" class="game-stage">
                    <div class="score-display">Skor: <span id="pacman-score">0</span></div>
                    <canvas id="pacman-canvas" width="400" height="400"></canvas>
                    <div class="game-controls">
                        <button class="ctrl-btn stop" onclick="showGameMenu()">Çıkış</button>
                        <small style="margin-left:10px; align-self:center;">Yön Tuşlarını Kullan</small>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // --- MODAL YÖNETİMİ ---
        function openModal(id) {
            document.getElementById('modal-' + id).classList.add('active');
        }
        function closeModal(id) {
            document.getElementById('modal-' + id).classList.remove('active');
        }
        function showGameMenu() {
            closeAllGames();
            document.querySelectorAll('.game-stage').forEach(el => el.classList.remove('active'));
            document.getElementById('game-menu').style.display = 'grid';
        }
        function closeAllGames() {
            // Tüm oyun döngülerini durdur
            cancelAnimationFrame(tetrisId);
            clearInterval(snakeInterval);
            clearInterval(pacmanInterval);
        }

        // ================= TETRIS OYUNU =================
        const tCanvas = document.getElementById('tetris-canvas');
        const tCtx = tCanvas.getContext('2d');
        const ROW = 20;
        const COL = 12; // 240 / 20 = 12
        const SQ = 20;
        const VACANT = "#2d3436"; // Boş kare rengi

        let board = [];
        let tetrisScore = 0;
        let tetrisId;
        let piece;
        let dropStart = Date.now();
        let gameOverTetris = false;

        const PIECES = [
            [Z, "red"], [S, "green"], [T, "purple"], [O, "yellow"], [L, "orange"], [I, "cyan"], [J, "blue"]
        ];

        // Parça tanımları
        const I = [[ [0, 0, 0, 0], [1, 1, 1, 1], [0, 0, 0, 0], [0, 0, 0, 0] ], [ [0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 1, 0] ], [ [0, 0, 0, 0], [0, 0, 0, 0], [1, 1, 1, 1], [0, 0, 0, 0] ], [ [0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 0, 0] ]];
        const J = [[ [1, 0, 0], [1, 1, 1], [0, 0, 0] ], [ [0, 1, 1], [0, 1, 0], [0, 1, 0] ], [ [0, 0, 0], [1, 1, 1], [0, 0, 1] ], [ [0, 1, 0], [0, 1, 0], [1, 1, 0] ]];
        const L = [[ [0, 0, 1], [1, 1, 1], [0, 0, 0] ], [ [0, 1, 0], [0, 1, 0], [0, 1, 1] ], [ [0, 0, 0], [1, 1, 1], [1, 0, 0] ], [ [1, 1, 0], [0, 1, 0], [0, 1, 0] ]];
        const O = [[ [0, 0, 0, 0], [0, 1, 1, 0], [0, 1, 1, 0], [0, 0, 0, 0] ]];
        const S = [[ [0, 1, 1], [1, 1, 0], [0, 0, 0] ], [ [0, 1, 0], [0, 1, 1], [0, 0, 1] ], [ [0, 0, 0], [0, 1, 1], [1, 1, 0] ], [ [1, 0, 0], [1, 1, 0], [0, 1, 0] ]];
        const T = [[ [0, 1, 0], [1, 1, 1], [0, 0, 0] ], [ [0, 1, 0], [0, 1, 1], [0, 1, 0] ], [ [0, 0, 0], [1, 1, 1], [0, 1, 0] ], [ [0, 1, 0], [1, 1, 0], [0, 1, 0] ]];
        const Z = [[ [1, 1, 0], [0, 1, 1], [0, 0, 0] ], [ [0, 0, 1], [0, 1, 1], [0, 1, 0] ], [ [0, 0, 0], [1, 1, 0], [0, 1, 1] ], [ [0, 1, 0], [1, 1, 0], [1, 0, 0] ]];

        function startTetris() {
            document.getElementById('game-menu').style.display = 'none';
            document.getElementById('stage-tetris').classList.add('active');
            
            // Tahtayı sıfırla
            board = [];
            for(let r=0; r<ROW; r++){
                board[r] = [];
                for(let c=0; c<COL; c++){
                    board[r][c] = VACANT;
                }
            }
            tetrisScore = 0;
            document.getElementById('tetris-score').innerHTML = tetrisScore;
            gameOverTetris = false;
            drawBoard();
            piece = randomPiece();
            dropStart = Date.now();
            drop();
            
            // Klavye dinleyicisi
            document.addEventListener('keydown', controlTetris);
        }

        function drawSquare(x,y,color){
            tCtx.fillStyle = color;
            tCtx.fillRect(x*SQ, y*SQ, SQ, SQ);
            tCtx.strokeStyle = "#333";
            tCtx.strokeRect(x*SQ, y*SQ, SQ, SQ);
        }

        function drawBoard(){
            for(let r=0; r<ROW; r++){
                for(let c=0; c<COL; c++){
                    drawSquare(c, r, board[r][c]);
                }
            }
        }

        function randomPiece(){
            // PIECES arrayinde harfler değişken isimleri, string değil. O yüzden yukarıda const I = ... diye tanımladık ama 
            // array içinde doğrudan kullanamayız, string isimle eşleştirelim ya da basitçe:
            // Basitleştirme için tüm şekilleri manuel arraye aldım.
            let r = Math.floor(Math.random() * 7);
            let shapes = [I, J, L, O, S, T, Z];
            let colors = ["cyan", "blue", "orange", "yellow", "green", "purple", "red"];
            return new Piece(shapes[r], colors[r]);
        }

        function Piece(tetromino, color){
            this.tetromino = tetromino;
            this.color = color;
            this.tetrominoN = 0; // ilk rotasyon
            this.activeTetromino = this.tetromino[this.tetrominoN];
            this.x = 3;
            this.y = -2;
        }

        Piece.prototype.fill = function(color){
            for(let r=0; r<this.activeTetromino.length; r++){
                for(let c=0; c<this.activeTetromino.length; c++){
                    if(this.activeTetromino[r][c]){
                        drawSquare(this.x + c, this.y + r, color);
                    }
                }
            }
        }

        Piece.prototype.draw = function(){ this.fill(this.color); }
        Piece.prototype.unDraw = function(){ this.fill(VACANT); }

        Piece.prototype.moveDown = function(){
            if(!this.collision(0, 1, this.activeTetromino)){
                this.unDraw();
                this.y++;
                this.draw();
            } else {
                this.lock();
                piece = randomPiece();
            }
        }

        Piece.prototype.moveRight = function(){
            if(!this.collision(1, 0, this.activeTetromino)){
                this.unDraw();
                this.x++;
                this.draw();
            }
        }
        Piece.prototype.moveLeft = function(){
            if(!this.collision(-1, 0, this.activeTetromino)){
                this.unDraw();
                this.x--;
                this.draw();
            }
        }
        Piece.prototype.rotate = function(){
            let nextPattern = this.tetromino[(this.tetrominoN + 1) % this.tetromino.length];
            let kick = 0;
            if(this.collision(0, 0, nextPattern)){
                if(this.x > COL/2) kick = -1; else kick = 1;
            }
            if(!this.collision(kick, 0, nextPattern)){
                this.unDraw();
                this.x += kick;
                this.tetrominoN = (this.tetrominoN + 1) % this.tetromino.length;
                this.activeTetromino = this.tetromino[this.tetrominoN];
                this.draw();
            }
        }

        Piece.prototype.collision = function(x, y, piece){
            for(let r=0; r<piece.length; r++){
                for(let c=0; c<piece.length; c++){
                    if(!piece[r][c]) continue;
                    let newX = this.x + c + x;
                    let newY = this.y + r + y;
                    if(newX < 0 || newX >= COL || newY >= ROW) return true;
                    if(newY < 0) continue;
                    if(board[newY][newX] != VACANT) return true;
                }
            }
            return false;
        }

        Piece.prototype.lock = function(){
            for(let r=0; r<this.activeTetromino.length; r++){
                for(let c=0; c<this.activeTetromino.length; c++){
                    if(!this.activeTetromino[r][c]) continue;
                    if(this.y + r < 0){
                        alert("Oyun Bitti! Skor: " + tetrisScore);
                        gameOverTetris = true;
                        break;
                    }
                    board[this.y + r][this.x + c] = this.color;
                }
            }
            // Satır silme
            for(let r=0; r<ROW; r++){
                let isRowFull = true;
                for(let c=0; c<COL; c++){
                    if(board[r][c] == VACANT) isRowFull = false;
                }
                if(isRowFull){
                    for(let y=r; y>1; y--){
                        for(let c=0; c<COL; c++){
                            board[y][c] = board[y-1][c];
                        }
                    }
                    for(let c=0; c<COL; c++) board[0][c] = VACANT;
                    tetrisScore += 10;
                    document.getElementById('tetris-score').innerHTML = tetrisScore;
                }
            }
            drawBoard();
        }

        function drop(){
            if(gameOverTetris) return;
            let now = Date.now();
            let delta = now - dropStart;
            if(delta > 1000){
                piece.moveDown();
                dropStart = Date.now();
            }
            if(!gameOverTetris) tetrisId = requestAnimationFrame(drop);
        }

        function controlTetris(event){
            if(document.getElementById('stage-tetris').style.display != 'flex') return;
            if(event.keyCode == 37) piece.moveLeft();
            else if(event.keyCode == 38) piece.rotate();
            else if(event.keyCode == 39) piece.moveRight();
            else if(event.keyCode == 40) piece.moveDown();
        }

        // ================= YILAN (SNAKE) OYUNU =================
        const sCanvas = document.getElementById('snake-canvas');
        const sCtx = sCanvas.getContext('2d');
        const box = 20; // grid size
        let snake = [];
        let food = {};
        let scoreSnake = 0;
        let d; // direction
        let snakeInterval;

        function startSnake(){
            document.getElementById('game-menu').style.display = 'none';
            document.getElementById('stage-snake').classList.add('active');
            
            snake = [];
            snake[0] = { x: 9 * box, y: 10 * box };
            scoreSnake = 0;
            d = null;
            document.getElementById('snake-score').innerHTML = scoreSnake;
            
            food = {
                x: Math.floor(Math.random() * 19 + 1) * box,
                y: Math.floor(Math.random() * 19 + 1) * box
            }
            
            document.addEventListener("keydown", directionSnake);
            if(snakeInterval) clearInterval(snakeInterval);
            snakeInterval = setInterval(drawSnake, 100);
        }

        function directionSnake(event){
            let key = event.keyCode;
            if( key == 37 && d != "RIGHT") d = "LEFT";
            else if(key == 38 && d != "DOWN") d = "UP";
            else if(key == 39 && d != "LEFT") d = "RIGHT";
            else if(key == 40 && d != "UP") d = "DOWN";
        }

        function drawSnake(){
            sCtx.fillStyle = "#2d3436";
            sCtx.fillRect(0, 0, 400, 400);

            for( let i = 0; i < snake.length; i++){
                sCtx.fillStyle = ( i == 0 ) ? "#00cec9" : "white";
                sCtx.fillRect(snake[i].x, snake[i].y, box, box);
                sCtx.strokeStyle = "#2d3436";
                sCtx.strokeRect(snake[i].x, snake[i].y, box, box);
            }

            sCtx.fillStyle = "#fd79a8";
            sCtx.fillRect(food.x, food.y, box, box);

            let snakeX = snake[0].x;
            let snakeY = snake[0].y;

            if( d == "LEFT") snakeX -= box;
            if( d == "UP") snakeY -= box;
            if( d == "RIGHT") snakeX += box;
            if( d == "DOWN") snakeY += box;

            // Yem yeme
            if(snakeX == food.x && snakeY == food.y){
                scoreSnake++;
                document.getElementById('snake-score').innerHTML = scoreSnake;
                food = {
                    x: Math.floor(Math.random() * 19 + 1) * box,
                    y: Math.floor(Math.random() * 19 + 1) * box
                }
            } else {
                snake.pop();
            }

            // Çarpışma kontrolü
            if(snakeX < 0 || snakeX > 19 * box || snakeY < 0 || snakeY > 19 * box || collisionSnake(snakeX, snakeY, snake)){
                clearInterval(snakeInterval);
                alert("Oyun Bitti! Skorun: " + scoreSnake);
            }

            let newHead = { x : snakeX, y : snakeY };
            snake.unshift(newHead);
        }

        function collisionSnake(headx, heady, array){
            for(let i = 0; i < array.length; i++){
                if(headx == array[i].x && heady == array[i].y) return true;
            }
            return false;
        }


        // ================= PAC-MAN LITE =================
        const pCanvas = document.getElementById('pacman-canvas');
        const pCtx = pCanvas.getContext('2d');
        let pacmanInterval;
        let pacScore = 0;
        
        // 1=Duvar, 0=Yem, 2=Boş, 9=Pacman
        // 20x20 grid, 400x400 canvas -> her kare 20px
        let map = [
            [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [1,9,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1],
            [1,0,1,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1,0,1],
            [1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1],
            [1,0,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1],
            [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
            [1,1,1,0,1,0,1,1,1,2,2,1,1,1,0,1,0,1,1,1],
            [1,0,0,0,1,0,1,2,2,2,2,2,2,1,0,1,0,0,0,1],
            [1,0,1,1,1,0,1,2,1,1,1,1,2,1,0,1,1,1,0,1],
            [1,0,0,0,0,0,0,2,1,2,2,1,2,0,0,0,0,0,0,1],
            [1,0,1,1,1,0,1,2,1,1,1,1,2,1,0,1,1,1,0,1],
            [1,0,1,0,0,0,1,2,2,2,2,2,2,1,0,0,0,1,0,1],
            [1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1,0,1],
            [1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],
            [1,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,0,1,1,1],
            [1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1],
            [1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1],
            [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
            [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
            [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1] 
        ];

        let pacman = {x:1, y:1, dir: 'right', nextDir: 'right'};
        let ghost = {x:9, y:9}; // Basit bir hayalet

        function startPacman(){
            document.getElementById('game-menu').style.display = 'none';
            document.getElementById('stage-pacman').classList.add('active');
            
            // Haritayı sıfırla (yemleri geri getir)
            pacScore = 0;
            document.getElementById('pacman-score').innerHTML = pacScore;
            
            // Haritayı manuel kopyalayarak resetle (basit yöntem)
            resetMap();

            pacman = {x:1, y:1, dir:'right', nextDir:'right'};
            ghost = {x:9, y:9};
            
            document.addEventListener('keydown', (e) => {
                if(e.keyCode == 37) pacman.nextDir = 'left';
                if(e.keyCode == 38) pacman.nextDir = 'up';
                if(e.keyCode == 39) pacman.nextDir = 'right';
                if(e.keyCode == 40) pacman.nextDir = 'down';
            });

            if(pacmanInterval) clearInterval(pacmanInterval);
            pacmanInterval = setInterval(updatePacman, 150);
        }

        function resetMap() {
            // Yemleri (0) tekrar yerine koymak için basit döngü. 
            // 2 olanlar boşluk (hayalet evi vs), 9 başlangıç, 1 duvar.
            // Bu demo için harita dizisini yeniden tanımlayacağız.
            map[1][1] = 2; // eski pacman yeri boş olsun
             // (Basitlik için yemleri topladıkça array değişiyor, 
             // tam reset için yukarıdaki map arrayini tekrar tanımlamak en temizi ama
             // kod çok uzamasın diye sadece skoru sıfırlayıp mevcut haritadan devam ediyoruz
             // eğer tüm yemler bitmişse oyun biter zaten.)
             // *Not: Tam bir oyun deneyimi için map'i klonlamak gerekir.*
             // Hızlı çözüm: Yemleri rastgele 0 yapalım.
             for(let y=0; y<20; y++){
                 for(let x=0; x<20; x++){
                     if(map[y][x] == 2) map[y][x] = 0; // boşlukları yeme çevir
                     if(map[y][x] == 9) map[y][x] = 0;
                 }
             }
        }

        function updatePacman(){
            let nextX = pacman.x;
            let nextY = pacman.y;

            if(pacman.nextDir == 'left') nextX--;
            if(pacman.nextDir == 'right') nextX++;
            if(pacman.nextDir == 'up') nextY--;
            if(pacman.nextDir == 'down') nextY++;

            if(map[nextY][nextX] != 1) {
                pacman.x = nextX;
                pacman.y = nextY;
                pacman.dir = pacman.nextDir;
            } else {
                // Dönemezse düz gitmeye çalış
                nextX = pacman.x;
                nextY = pacman.y;
                if(pacman.dir == 'left') nextX--;
                if(pacman.dir == 'right') nextX++;
                if(pacman.dir == 'up') nextY--;
                if(pacman.dir == 'down') nextY++;
                
                if(map[nextY][nextX] != 1){
                    pacman.x = nextX;
                    pacman.y = nextY;
                }
            }

            // Yem yeme
            if(map[pacman.y][pacman.x] == 0){
                map[pacman.y][pacman.x] = 2;
                pacScore += 10;
                document.getElementById('pacman-score').innerText = pacScore;
            }

            // Hayalet Hareketi (Rastgele)
            let gDirs = [[0,1], [0,-1], [1,0], [-1,0]];
            let gMove = gDirs[Math.floor(Math.random()*4)];
            if(map[ghost.y + gMove[1]][ghost.x + gMove[0]] != 1){
                ghost.x += gMove[0];
                ghost.y += gMove[1];
            }

            // Çarpışma
            if(pacman.x == ghost.x && pacman.y == ghost.y){
                clearInterval(pacmanInterval);
                alert("Hayalete Yakalandın! Skor: " + pacScore);
            }

            drawPacman();
        }

        function drawPacman(){
            pCtx.fillStyle = "black";
            pCtx.fillRect(0,0,400,400);
            
            for(let y=0; y<20; y++){
                for(let x=0; x<20; x++){
                    if(map[y][x] == 1){
                        pCtx.fillStyle = "blue";
                        pCtx.fillRect(x*20, y*20, 18, 18);
                    } else if(map[y][x] == 0){
                        pCtx.fillStyle = "white";
                        pCtx.beginPath();
                        pCtx.arc(x*20+10, y*20+10, 3, 0, Math.PI*2);
                        pCtx.fill();
                    }
                }
            }
            
            // Pacman
            pCtx.fillStyle = "yellow";
            pCtx.beginPath();
            pCtx.arc(pacman.x*20+10, pacman.y*20+10, 8, 0.2*Math.PI, 1.8*Math.PI);
            pCtx.fill();

            // Ghost
            pCtx.fillStyle = "red";
            pCtx.beginPath();
            pCtx.arc(ghost.x*20+10, ghost.y*20+10, 8, 0, Math.PI*2);
            pCtx.fill();
        }

    </script>
</body>
</html>
